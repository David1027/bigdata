(function(){var a={config:{host:"",url:"/analytics/api/analytics",key:"shoestp",project:"bigdata"},init:function(){var c=this;if(sessionStorage&&!sessionStorage[c.config.key+c.config.project]){sessionStorage[c.config.key+c.config.project]=document.referrer}if(localStorage&&localStorage[c.config.key+"userKey"]){this.data.userInfo=localStorage[c.config.key+"userKey"]}var b=null;if(document.onmousedown){b=document.onmousedown}document.onmousedown=function(e){var d=e||event;c.data.mouseClick.push({x:d.clientX,y:d.clientY,scroll:c.ScollPostion(),date:new Date()});if(b){b(e)}};if(sysConfig&&sysConfig.user){c.data.userInfo={id:sysConfig.user.id,userName:sysConfig.user.name,email:sysConfig.user.name}}if(!c.data.userInfo){this.ajax.get(this.config.host+"/api/analytics/device_sign",function(d){d=JSON.parse(d);c.cookie.set("__"+c.config.key+"_UUID",d.result,"d360");c.data.userInfo={userName:d.result}})}window.addEventListener("unload",function(d){c.data.firstReferrer=sessionStorage[c.config.key+c.config.project];navigator.sendBeacon(c.config.host+c.config.url,JSON.stringify(c.data))})},data:{title:document.title,url:window.location.href,firstReferrer:sessionStorage.bigdata,pageReferrer:document.referrer,pageLoadInfo:window.performance.timing,mouseClick:[],windows:{height:window.screen.height,width:window.screen.width},userInfo:null},ScollPostion:function(){var d,c,b,e;if(document.documentElement&&document.documentElement.scrollTop){d=document.documentElement.scrollTop;c=document.documentElement.scrollLeft;b=document.documentElement.scrollWidth;e=document.documentElement.scrollHeight}else{if(document.body){d=document.body.scrollTop;c=document.body.scrollLeft;b=document.body.scrollWidth;e=document.body.scrollHeight}}return{top:d,left:c,width:b,height:e}},ajax:{get:function(b,c){var d=new XMLHttpRequest();d.open("GET",b,true);d.onreadystatechange=function(){if(d.readyState==4&&d.status==200||d.status==304){c.call(this,d.responseText)}};d.send()},post:function(c,e,d,b){if(!b){b="application/x-www-form-urlencoded"}var f=new XMLHttpRequest();f.open("POST",c,true);f.setRequestHeader("Content-Type",b);f.onreadystatechange=function(){if(f.readyState==4&&(f.status==200||f.status==304)){d.call(this,f.responseText)}};f.send(e)}},cookie:{get:function(c){var b,d=new RegExp("(^| )"+c+"=([^;]*)(;|$)");if(b=document.cookie.match(d)){return unescape(b[2])}else{return null}},set:function(b,d,f){function e(j){var i=j.substring(1,j.length)*1;var h=j.substring(0,1);if(h=="s"){return i*1000}else{if(h=="h"){return i*60*60*1000}else{if(h=="d"){return i*24*60*60*1000}}}}var c=e(f);var g=new Date();g.setTime(g.getTime()+c*1);document.cookie=b+"="+escape(d)+";expires="+g.toUTCString()}}};a.init()})(window);